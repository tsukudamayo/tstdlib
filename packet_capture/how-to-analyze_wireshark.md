#wiresharkで取得したログの解析方法

##ネットワークのエンドポイントと対話
###ネットワークの対話を見る
- "統計" -> "カンバセーション"でカンバセーションダイアログが表示される
- [Adrres A]と[Adrress B]という形式で表示されているパケットが表示
- 各ホストが送受信しているパケット数とバイト数が表示される
- ネットワーク上で大量のトラフィック量の発生源を突き止められる
- 通信量が最も多いサーバはどれかを突き止められる
- バイト順にソートして表示される
- ローカルのアドレスのIPのトラフィックが多ければ、それが原因である
- ローカルでないアドレスならば、あるクライアントがこのIPアドレスに大量にデータを送っているのか、それとも、複数のアドレスからそれなりのデータが送られているのかわからない
- しかし、Whois検索(http://whois.arin.net/ui/) をかけることによって、このサーバがGoogleのものであることが分かったり、パケットを調べれば、YouTubeのトラフィックであることがわかる

##プロトコルの階層統計
- 巨大なキャプチャファイルを解析する場合に、何パーセントがTCPで、何パーセントがIP、何パーセントがDHCPであるか、各プロトコルがどのような配分になっているかを確認する必要がある
- "統計" -> "プロトコル階層"を選択して確認
- トラフィックに精通するようになると、使われているプロトコルの割合を見るだけで、ネットワーク上のユーザーや機器の概況がわかるようになる

##プロトコル分析機構
- 分析機構はパケットを流れる生のデータとパケットの間の翻訳機のようなもの
- wiresharkがプロトコルをサポートするには、そのプロトコルの分析機構がwiresharkに内蔵されている必要がある(C or Pythonで記述)
- wiresharkがいつも正しい分析機構を選択するとは限らない

##TCPストリームの表示
- TCPまたはHTTPのパケットを選択して、右クリックして -> "追跡" -> "TCPストリーム"を選択
- HTTPやTCPの平文のアプリケーション層プロトコルを参照する際に有益
- ダイアログのテキストは2種類に色分けされる
  - 赤は送信元から宛先へのトラフィック
  - 青は宛先から送信元へのトラフィック

##パケット長
- "統計" -> "パケット長"
- パケットを調べると、キャプチャの全体像がわかる
- サイズの大きなパケットがたくさんあれば、データが転送されていると考える
- サイズの小さなパケットがたくさんあれば、プロトコル制御命令で構成されていると考える

##グラフ表示
###IOGraph
- IOGraphでダイアログで送受信されているデータのスループットをグラフ化することができる
- 各プロトコルのパフォーマンス遅延を確認したり、複数のデータストリームを同時に比較することが可能
- "統計" -> "IOGraph" を選択
- 最大5つまでのフィルタを作成でき、色分けして表示することができる

###ラウンドトリップタイム
- パケットが宛先に届き、その返答が自分に返ってくるまでの時間
- RTTの分析は、通信の遅延が発生したポイントやボトルネックを見つけて、遅延の有無を確認するために行われる場合が多い
- "統計" -> "???" 

###フローグラフ
- コネクションを視覚化して、時間経過に伴うデータの流れを示すもの
- "統計" -> "フローグラフ"-

###エキスパート情報
- wiresharkでは、そのプロトコルが特定の状態になった際に警告を告げるために用いられる"エキスパート情報"を設定することができる
- エキスパート情報として設定できるのは以下の4つ
  - Chat - 通信の基本状態
  - Note - 通常の通信の一部であると考えられる異常なパケット
  - Warning - 通常の通信の一部であるとは考えられない異常なパケット
  - Error - パケットもしくはそれを解析した解析機構の中で発生したエラー
- "分析" -> "エキスパート情報"を選択

*フラグの詳細については後で書く*


